<div class="inventory-container">
  <!-- Inventory Header -->
  <div class="inventory-header">
    <h2>Inventory Management</h2>
    <button class="btn btn-primary" (click)="openCreateModal()">+ Add Item</button>
  </div>

  <!-- Filter Form -->
  <form [formGroup]="filterForm" class="inventory-filter">
    <input type="text" placeholder="Search..." formControlName="searchTerm">
    <select formControlName="category">
      <option value="">All Categories</option>
      <option *ngFor="let category of categories()" [value]="category">{{ category }}</option>
    </select>
    <select formControlName="status">
      <option value="">All Statuses</option>
      <option value="in-stock">In Stock</option>
      <option value="low-stock">Low Stock</option>
      <option value="out-of-stock">Out of Stock</option>
      <option value="expired">Expired</option>
    </select>
    <button type="button" (click)="clearFilters()">Clear</button>
  </form>

  <!-- Inventory Table -->
  <div *ngIf="loading()">Loading inventory...</div>

  <table *ngIf="!loading() && filteredInventory().length > 0" class="inventory-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Category</th>
        <th>Qty</th>
        <th>Unit</th>
        <th>Unit Price</th>
        <th>Total Value</th>
        <th>Status</th>
        <th>Supplier</th>
        <th>Expiry</th>
        <th>Location</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of filteredInventory(); trackBy: trackByItemId">
        <td>{{ item.name }}</td>
        <td>{{ item.category }}</td>
        <td>{{ item.quantity }}</td>
        <td>{{ item.unit }}</td>
        <td>{{ item.unitPrice | currency }}</td>
        <td>{{ item.totalValue | currency }}</td>
        <td>
          <span [ngClass]="getStatusClass(item.status)">
            {{ item.status }}
          </span>
        </td>
        <td>{{ item.supplier }}</td>
        <td>{{ item.expiryDate ? (item.expiryDate | date:'yyyy-MM-dd') : '-' }}</td>
        <td>{{ item.location }}</td>
        <td>
          <button (click)="openEditModal(item)">Edit</button>
          <button (click)="deleteItem(item.id)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="!loading() && filteredInventory().length === 0" class="empty-state">
    <p>No inventory items match the current filter.</p>
  </div>

  <!-- Modal -->
  <div class="modal" *ngIf="showModal()">
    <div class="modal-content">
      <h3 *ngIf="!editingItem()">Add Item</h3>
      <h3 *ngIf="editingItem()">Edit Item</h3>
      <form [formGroup]="inventoryForm" (ngSubmit)="onSubmit()">
        <input formControlName="name" placeholder="Item Name">
        <textarea formControlName="description" placeholder="Description"></textarea>
        <input formControlName="category" placeholder="Category">
        <input formControlName="quantity" type="number" placeholder="Quantity">
        <input formControlName="unit" placeholder="Unit">
        <input formControlName="unitPrice" type="number" placeholder="Unit Price">
        <input formControlName="supplier" placeholder="Supplier">
        <input formControlName="expiryDate" type="date" placeholder="Expiry Date">
        <input formControlName="minimumStock" type="number" placeholder="Minimum Stock">
        <input formControlName="location" placeholder="Location">
        <input formControlName="batchNumber" placeholder="Batch Number">
        <div class="modal-actions">
          <button type="submit" [disabled]="inventoryForm.invalid">Save</button>
          <button type="button" (click)="closeModal()">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>
