<div class="questionnaire-container">
  <div class="questionnaire-header">
    <h1>Cervical Cancer Screening Questionnaire</h1>
    <p>Please provide accurate information to help us assess your health needs</p>
  </div>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar">
      <div 
        class="progress-fill"
        [style.width.%]="progressPercentage">
      </div>
    </div>
  </div>

  <!-- Page Indicators -->
  <div class="page-indicators">
    <div
      *ngFor="let page of pages"
      class="page-indicator"
      [ngClass]="getPageClass(page.num)"
      (click)="nextPage()"
    >
      <mat-icon>{{ page.icon }}</mat-icon>
      <span>{{ page.title }}</span>
    </div>
  </div>

  <form [formGroup]="patientForm" (ngSubmit)="onSubmit()">
    <div class="form-container">
      
      <!-- Page 1: Personal Details -->
      <div *ngIf="currentPage === 1" class="form-page">
        <h2>Personal Details</h2>
        
        <div class="form-grid form-grid-2">
          <mat-form-field appearance="outline">
            <mat-label>Full Name *</mat-label>
            <input matInput formControlName="fullName" placeholder="Enter full name">
            <mat-error *ngIf="isFieldInvalid('fullName')">
              {{ getErrorMessage('fullName') }}
            </mat-error>
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Age *</mat-label>
            <input matInput type="number" formControlName="age" placeholder="Enter age">
            <mat-error *ngIf="isFieldInvalid('age')">
              {{ getErrorMessage('age') }}
            </mat-error>
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Email</mat-label>
            <input matInput type="email" formControlName="email" placeholder="Enter email address">
            <mat-error *ngIf="isFieldInvalid('email')">
              {{ getErrorMessage('email') }}
            </mat-error>
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Phone Number *</mat-label>
            <input matInput type="tel" formControlName="phoneNumber" placeholder="Enter phone number">
            <mat-error *ngIf="isFieldInvalid('phoneNumber')">
              {{ getErrorMessage('phoneNumber') }}
            </mat-error>
          </mat-form-field>
        </div>
        
        <mat-form-field appearance="outline">
          <mat-label>Address</mat-label>
          <textarea matInput formControlName="address" rows="3" placeholder="Enter full address"></textarea>
        </mat-form-field>
        
        <div class="form-grid form-grid-2">
          <mat-form-field appearance="outline">
            <mat-label>Emergency Contact Name</mat-label>
            <input matInput formControlName="emergencyContact" placeholder="Enter emergency contact name">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Emergency Contact Phone</mat-label>
            <input matInput type="tel" formControlName="emergencyPhone" placeholder="Enter emergency contact phone">
          </mat-form-field>
        </div>
      </div>

      <!-- Page 2: Medical History -->
      <div *ngIf="currentPage === 2" class="form-page">
        <h2>Medical History</h2>
        
        <mat-form-field appearance="outline">
          <mat-label>Chronic Conditions</mat-label>
          <textarea matInput formControlName="chronicConditions" rows="3" 
                    placeholder="List any chronic conditions (e.g., diabetes, hypertension, heart disease)"></textarea>
        </mat-form-field>
        
        <mat-form-field appearance="outline">
          <mat-label>Current Medications</mat-label>
          <textarea matInput formControlName="currentMedications" rows="3" 
                    placeholder="List all current medications including dosages"></textarea>
        </mat-form-field>
        
        <mat-form-field appearance="outline">
          <mat-label>Allergies</mat-label>
          <textarea matInput formControlName="allergies" rows="3" 
                    placeholder="List any known allergies to medications, foods, or other substances"></textarea>
        </mat-form-field>
        
        <mat-form-field appearance="outline">
          <mat-label>Previous Surgeries</mat-label>
          <textarea matInput formControlName="previousSurgeries" rows="3" 
                    placeholder="List any previous surgeries with dates"></textarea>
        </mat-form-field>
        
        <mat-form-field appearance="outline">
          <mat-label>Family History of Cancer</mat-label>
          <textarea matInput formControlName="familyHistory" rows="3" 
                    placeholder="List any family history of cancer, especially cervical, ovarian, or breast cancer"></textarea>
        </mat-form-field>
      </div>

      <!-- Page 3: Gynecological History -->
      <div *ngIf="currentPage === 3" class="form-page">
        <h2>Gynecological History</h2>
        
        <div class="form-grid form-grid-2">
          <mat-form-field appearance="outline">
            <mat-label>Age at First Menstruation</mat-label>
            <input matInput type="number" formControlName="ageFirstMenstruation" placeholder="Enter age">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Menstrual Cycle</mat-label>
            <mat-select formControlName="menstrualCycle">
              <mat-option value="">Select...</mat-option>
              <mat-option *ngFor="let option of menstrualCycleOptions" [value]="option.value">
                {{ option.label }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Last Menstrual Period</mat-label>
            <input matInput type="date" formControlName="lastMenstrualPeriod">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Number of Pregnancies</mat-label>
            <input matInput type="number" formControlName="pregnancies" placeholder="Enter number">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Live Births</mat-label>
            <input matInput type="number" formControlName="livebirths" placeholder="Enter number">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Miscarriages/Abortions</mat-label>
            <input matInput type="number" formControlName="miscarriages" placeholder="Enter number">
          </mat-form-field>
        </div>
        
        <mat-form-field appearance="outline">
          <mat-label>Current Contraceptive Method</mat-label>
          <mat-select formControlName="contraceptiveMethod">
            <mat-option value="">Select...</mat-option>
            <mat-option *ngFor="let option of contraceptiveOptions" [value]="option.value">
              {{ option.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Page 4: Sexual Health -->
      <div *ngIf="currentPage === 4" class="form-page">
        <h2>Sexual Health</h2>
        
        <div class="form-grid form-grid-2">
          <mat-form-field appearance="outline">
            <mat-label>Age at First Sexual Activity</mat-label>
            <input matInput type="number" formControlName="ageFirstSexualActivity" placeholder="Enter age">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Number of Sexual Partners (Lifetime)</mat-label>
            <mat-select formControlName="numberOfPartners">
              <mat-option value="">Select...</mat-option>
              <mat-option *ngFor="let option of partnerOptions" [value]="option.value">
                {{ option.label }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        
        <div>
          <label class="field-label">Currently Sexually Active?</label>
          <mat-radio-group formControlName="currentlyActive">
            <mat-radio-button value="yes">Yes</mat-radio-button>
            <mat-radio-button value="no">No</mat-radio-button>
          </mat-radio-group>
        </div>
        
        <mat-form-field appearance="outline">
          <mat-label>History of STIs (You or Partner)</mat-label>
          <textarea matInput formControlName="partnerSTIHistory" rows="3" 
                    placeholder="List any history of sexually transmitted infections"></textarea>
        </mat-form-field>
      </div>

      <!-- Page 5: Screening History -->
      <div *ngIf="currentPage === 5" class="form-page">
        <h2>Screening History</h2>
        
        <div class="form-grid form-grid-2">
          <mat-form-field appearance="outline">
            <mat-label>Last Pap Smear Date</mat-label>
            <input matInput type="date" formControlName="lastPapSmear">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Last Pap Smear Results</mat-label>
            <mat-select formControlName="papSmearResults">
              <mat-option value="">Select...</mat-option>
              <mat-option *ngFor="let option of testResultOptions" [value]="option.value">
                {{ option.label }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>Last HPV Test Date</mat-label>
            <input matInput type="date" formControlName="lastHPVTest">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>HPV Test Results</mat-label>
            <mat-select formControlName="hpvResults">
              <mat-option value="">Select...</mat-option>
              <mat-option *ngFor="let option of hpvResultOptions" [value]="option.value">
                {{ option.label }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        
        <mat-form-field appearance="outline">
          <mat-label>Any Previous Abnormal Results or Treatments?</mat-label>
          <textarea matInput formControlName="abnormalResults" rows="3" 
                    placeholder="Describe any abnormal results and treatments received"></textarea>
        </mat-form-field>
      </div>

      <!-- Page 6: Lifestyle Factors -->
      <div *ngIf="currentPage === 6" class="form-page">
        <h2>Lifestyle Factors</h2>
        
        <mat-form-field appearance="outline">
          <mat-label>Smoking Status</mat-label>
          <mat-select formControlName="smokingStatus">
            <mat-option value="">Select...</mat-option>
            <mat-option *ngFor="let option of smokingOptions" [value]="option.value">
              {{ option.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        
        <mat-form-field appearance="outline" *ngIf="showSmokingDuration">
          <mat-label>Duration of Smoking (Years)</mat-label>
          <input matInput type="number" formControlName="smokingDuration" placeholder="Enter number of years">
        </mat-form-field>
        
        <mat-form-field appearance="outline">
          <mat-label>Alcohol Consumption</mat-label>
          <mat-select formControlName="alcoholConsumption">
            <mat-option value="">Select...</mat-option>
            <mat-option *ngFor="let option of alcoholOptions" [value]="option.value">
              {{option.label}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        
       <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Immunocompromised Status</label>
          <mat-radio-group formControlName="immunocompromised" class="flex flex-col space-y-2">
            <mat-radio-button value="no">No</mat-radio-button>
            <mat-radio-button value="hiv">HIV Positive</mat-radio-button>
            <mat-radio-button value="medication">Taking Immunosuppressive Medication</mat-radio-button>
            <mat-radio-button value="other">Other Immunocompromising Condition</mat-radio-button>
          </mat-radio-group>
        </div>
      </div>

      <!-- Page 7: Current Symptoms -->
      <div *ngIf="currentPage === 7" class="space-y-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Current Symptoms</h2>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Abnormal Vaginal Bleeding</label>
          <mat-radio-group formControlName="abnormalBleeding" class="flex flex-col space-y-2">
            <mat-radio-button value="no">No</mat-radio-button>
            <mat-radio-button value="between-periods">Between Periods</mat-radio-button>
            <mat-radio-button value="after-intercourse">After Intercourse</mat-radio-button>
            <mat-radio-button value="after-menopause">After Menopause</mat-radio-button>
          </mat-radio-group>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Pelvic Pain</label>
          <mat-radio-group formControlName="pelvicPain" class="flex space-x-4">
            <mat-radio-button value="no">No</mat-radio-button>
            <mat-radio-button value="mild">Mild</mat-radio-button>
            <mat-radio-button value="moderate">Moderate</mat-radio-button>
            <mat-radio-button value="severe">Severe</mat-radio-button>
          </mat-radio-group>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Unusual Vaginal Discharge</label>
          <mat-radio-group formControlName="unusualDischarge" class="flex flex-col space-y-2">
            <mat-radio-button value="no">No</mat-radio-button>
            <mat-radio-button value="change-in-color">Change in Color</mat-radio-button>
            <mat-radio-button value="foul-odor">Foul Odor</mat-radio-button>
            <mat-radio-button value="increased-amount">Increased Amount</mat-radio-button>
          </mat-radio-group>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Pain During Intercourse</label>
          <mat-radio-group formControlName="painDuringIntercourse" class="flex space-x-4">
            <mat-radio-button value="no">No</mat-radio-button>
            <mat-radio-button value="sometimes">Sometimes</mat-radio-button>
            <mat-radio-button value="always">Always</mat-radio-button>
            <mat-radio-button value="not-applicable">Not Applicable</mat-radio-button>
          </mat-radio-group>
        </div>
        
        <mat-form-field appearance="outline" class="w-full">
          <mat-label>Other Symptoms</mat-label>
          <textarea matInput formControlName="otherSymptoms" rows="4" 
                    placeholder="Please describe any other symptoms you may be experiencing"></textarea>
        </mat-form-field>
      </div>
    </div>

    <!-- Navigation Buttons -->
    <div class="flex justify-between items-center">
      <button
        type="button"
        (click)="prevPage()"
        [disabled]="currentPage === 1"
        mat-raised-button
        [color]="currentPage === 1 ? '' : 'primary'"
        class="flex items-center"
      >
        <mat-icon>chevron_left</mat-icon>
        Previous
      </button>

      <div class="text-sm text-gray-500">
        Page {{ currentPage }} of {{ totalPages }}
      </div>

      <button
        *ngIf="currentPage < totalPages"
        type="button"
        (click)="nextPage()"
        mat-raised-button
        color="primary"
        class="flex items-center"
      >
        Next
        <mat-icon>chevron_right</mat-icon>
      </button>

      <button
        *ngIf="currentPage === totalPages"
        type="submit"
        mat-raised-button
        color="accent"
        class="flex items-center"
      >
        <mat-icon>check_circle</mat-icon>
        Submit
      </button>
    </div>
  </form>

  <!-- Privacy Notice -->
  <div class="mt-8 p-4 bg-blue-50 rounded-lg">
    <h3 class="font-semibold text-blue-800 mb-2">Privacy Notice</h3>
    <p class="text-sm text-blue-700">
      All information provided in this questionnaire is confidential and will be used solely for medical assessment and care. 
      Your data is protected according to healthcare privacy regulations.
    </p>
  </div>

</div>